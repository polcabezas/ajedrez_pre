# üèÜ ChessPy - Juego de Ajedrez Completo en Python

Un juego de ajedrez completamente funcional implementado en Python usando Pygame, con inteligencia artificial integrada y todas las reglas oficiales del ajedrez.

![Python](https://img.shields.io/badge/python-v3.8+-blue.svg)
![Pygame](https://img.shields.io/badge/pygame-2.0+-green.svg)
![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Status](https://img.shields.io/badge/status-active-success.svg)

## üéØ Caracter√≠sticas Principales

### ‚ú® Funcionalidades del Juego

- **Interfaz Gr√°fica Completa**: Desarrollada con Pygame con dise√±o moderno y intuitivo
- **Reglas Oficiales del Ajedrez**: Implementaci√≥n completa de todas las reglas FIDE
- **Inteligencia Artificial**: Librer√≠a python-chess con integraci√≥n UCI a Stockfish (opcional)
- **M√∫ltiples Modalidades**: Humano vs Humano, Humano vs CPU, CPU vs CPU
- **Sistema de Temporizadores**: Modalidades Cl√°sico, R√°pido y Blitz
- **Historial Completo**: Notaci√≥n algebraica est√°ndar (SAN) y exportaci√≥n PGN

### üèóÔ∏è Arquitectura T√©cnica

- **Patr√≥n MVC**: Separaci√≥n clara entre Modelo, Vista y Controlador
- **Programaci√≥n Orientada a Objetos**: Dise√±o modular y extensible
- **Patrones de Dise√±o**: Strategy, Template Method, Observer, Factory
- **Logging Avanzado**: Sistema de debugging profesional
- **C√≥digo Limpio**: Una clase por archivo, documentaci√≥n en espa√±ol

## üöÄ Instalaci√≥n y Uso

### Requisitos del Sistema

```bash
Python 3.8+
pygame >= 2.0.0
python-chess >= 1.999
Stockfish (opcional, para IA de nivel profesional)
```

### Instalaci√≥n

1. **Clonar el repositorio:**

```bash
git clone https://github.com/tu-usuario/ajedrez_pre.git
cd ajedrez_pre
```

2. **Instalar dependencias:**

```bash
pip install -r requirements.txt
```

3. **Instalar Stockfish (opcional para IA avanzada):**
   - **Windows**: Descargar desde [stockfishchess.org](https://stockfishchess.org/download/)
   - **macOS**: `brew install stockfish`
   - **Linux**: `sudo apt-get install stockfish`
   - **Nota**: Sin Stockfish, la CPU usar√° un algoritmo simple interno

### Ejecuci√≥n

```bash
python main.py
```

## üìÅ Estructura del Proyecto

```
ajedrez_pre/
‚îÇ
‚îú‚îÄ‚îÄ main.py                    # Punto de entrada principal
‚îú‚îÄ‚îÄ requirements.txt           # Dependencias del proyecto
‚îÇ
‚îú‚îÄ‚îÄ model/                     # üß† MODELO - L√≥gica del juego
‚îÇ   ‚îú‚îÄ‚îÄ juego.py              # Gesti√≥n del estado global
‚îÇ   ‚îú‚îÄ‚îÄ tablero.py            # Representaci√≥n del tablero
‚îÇ   ‚îú‚îÄ‚îÄ validador_movimiento.py   # Validaci√≥n de reglas
‚îÇ   ‚îú‚îÄ‚îÄ ejecutor_movimiento.py    # Ejecuci√≥n de movimientos
‚îÇ   ‚îú‚îÄ‚îÄ evaluador_estado_de_juego.py # Detecci√≥n de finales
‚îÇ   ‚îú‚îÄ‚îÄ gestor_del_historico.py   # Historial y notaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ temporizador.py       # Sistema de tiempos
‚îÇ   ‚îú‚îÄ‚îÄ configuracion_juego.py # Configuraciones de partida
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ piezas/               # Jerarqu√≠a de piezas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pieza.py         # Clase base abstracta
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rey.py           # Implementaci√≥n del Rey
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reina.py         # Implementaci√≥n de la Reina
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ torre.py         # Implementaci√≥n de la Torre
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alfil.py         # Implementaci√≥n del Alfil
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ caballo.py       # Implementaci√≥n del Caballo
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ peon.py          # Implementaci√≥n del Pe√≥n
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ jugadores/            # Sistema de jugadores
‚îÇ       ‚îú‚îÄ‚îÄ jugador.py       # Clase base abstracta
‚îÇ       ‚îú‚îÄ‚îÄ jugador_humano.py # Jugador humano
‚îÇ       ‚îî‚îÄ‚îÄ jugador_cpu.py   # IA con python-chess + Stockfish UCI
‚îÇ
‚îú‚îÄ‚îÄ view/                     # üé® VISTA - Interfaz gr√°fica
‚îÇ   ‚îî‚îÄ‚îÄ interfaz_ajedrez.py  # Interfaz completa con Pygame
‚îÇ
‚îú‚îÄ‚îÄ controller/               # üéÆ CONTROLADOR - L√≥gica de control
‚îÇ   ‚îî‚îÄ‚îÄ controlador_juego.py # Coordinaci√≥n MVC
‚îÇ
‚îú‚îÄ‚îÄ assets/                   # üìÅ Recursos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ imagenes_piezas/     # Sprites de las piezas
‚îÇ   ‚îú‚îÄ‚îÄ chess_rules/         # Documentaci√≥n de reglas
‚îÇ   ‚îî‚îÄ‚îÄ *.md, *.pdf          # Documentaci√≥n y diagramas
‚îÇ
‚îú‚îÄ‚îÄ tests/                    # üß™ Tests unitarios
‚îÇ   ‚îú‚îÄ‚îÄ model/               # Tests del modelo
‚îÇ   ‚îî‚îÄ‚îÄ controller/          # Tests del controlador
‚îÇ
‚îî‚îÄ‚îÄ chats/                    # üìù Historial de desarrollo
    ‚îî‚îÄ‚îÄ *.md                 # Registros de conversaciones
```

## üéÆ Gu√≠a de Uso

### Pantalla de Configuraci√≥n

1. **Seleccionar Tipo de Juego:**

   - Cl√°sico (90 min + 30 seg/movimiento)
   - R√°pido (25 min + 10 seg/movimiento)
   - Blitz (3 min + 2 seg/movimiento)

2. **Elegir Modalidad:**

   - Humano vs Humano
   - Humano vs CPU
   - CPU vs Humano
   - CPU vs CPU

3. **Configurar Dificultad CPU:**
   - Nivel 1 (Principiante)
   - Nivel 3 (Intermedio)
   - Nivel 5 (Avanzado)
   - Nivel 10 (Experto)

### Durante la Partida

- **Seleccionar Pieza**: Clic en una pieza propia
- **Ver Movimientos**: Los movimientos v√°lidos se resaltan autom√°ticamente
- **Mover Pieza**: Clic en casilla destino v√°lida
- **Promoci√≥n**: Seleccionar pieza en popup autom√°tico
- **Historial**: Panel lateral muestra movimientos en notaci√≥n algebraica

## üèõÔ∏è Arquitectura del Sistema

### Patr√≥n Modelo-Vista-Controlador (MVC)

#### üß† **MODELO** - L√≥gica del Negocio

```python
# Componentes principales del modelo
Juego              # Coordinador general del estado
‚îú‚îÄ‚îÄ Tablero        # Estado del tablero y piezas
‚îú‚îÄ‚îÄ Validador      # Validaci√≥n de reglas
‚îú‚îÄ‚îÄ Ejecutor       # Ejecuci√≥n de movimientos
‚îú‚îÄ‚îÄ Evaluador      # Detecci√≥n de finales
‚îú‚îÄ‚îÄ Gestor         # Historial y repeticiones
‚îî‚îÄ‚îÄ Jugadores      # IA y jugadores humanos
```

#### üé® **VISTA** - Interfaz de Usuario

```python
InterfazAjedrez    # Interfaz gr√°fica completa
‚îú‚îÄ‚îÄ Configuraci√≥n  # Pantalla inicial
‚îú‚îÄ‚îÄ Tablero        # Vista de juego
‚îú‚îÄ‚îÄ Popups         # Promoci√≥n y fin de juego
‚îî‚îÄ‚îÄ Paneles        # Informaci√≥n y controles
```

#### üéÆ **CONTROLADOR** - L√≥gica de Control

```python
ControladorJuego   # Coordinador MVC
‚îú‚îÄ‚îÄ Eventos        # Manejo de input del usuario
‚îú‚îÄ‚îÄ Estado         # Gesti√≥n del estado del juego
‚îî‚îÄ‚îÄ Comunicaci√≥n   # Modelo ‚Üî Vista
```

## ‚öôÔ∏è Patrones de Dise√±o Implementados

### üéØ **Strategy Pattern**

- **ValidadorMovimiento**: Diferentes algoritmos de validaci√≥n
- **EjecutorMovimiento**: Estrategias de ejecuci√≥n
- **EvaluadorEstado**: M√∫ltiples evaluadores de estado

### üèóÔ∏è **Template Method**

- **Pieza.obtener_movimientos_legales()**: Algoritmo general
- Subclases implementan partes espec√≠ficas (`obtener_movimientos_potenciales()`)

### üëÅÔ∏è **Observer Pattern**

- Controlador observa eventos de la vista
- Modelo notifica cambios de estado

### üè≠ **Factory Method**

- Creaci√≥n din√°mica de jugadores seg√∫n modalidad
- Instanciaci√≥n de piezas espec√≠ficas

## üîÑ Flujo de Trabajo del Juego

```mermaid
graph TD
    A[main.py] --> B[ControladorJuego]
    B --> C[InterfazAjedrez]
    C --> D[Pantalla Configuraci√≥n]
    D --> E[Usuario Configura]
    E --> F[Juego.configurar_nueva_partida]
    F --> G[Vista Tablero]
    G --> H[Bucle Principal]
    H --> I{¬øTurno Humano?}
    I -->|S√≠| J[Esperar Clic]
    I -->|No| K[CPU Calcula]
    J --> L[Validar Movimiento]
    K --> L
    L --> M[Ejecutar Movimiento]
    M --> N[Actualizar Estado]
    N --> O{¬øFin de Juego?}
    O -->|No| H
    O -->|S√≠| P[Mostrar Resultado]
```

## üß™ Testing

Ejecutar tests unitarios:

```bash
# Todos los tests
pytest tests/

# Tests espec√≠ficos del modelo
pytest tests/model/

# Tests del controlador
pytest tests/controller/

# Test espec√≠fico
pytest tests/model/test_tablero.py
```

## üöÄ Reglas del Ajedrez Implementadas

### ‚úÖ **Movimientos B√°sicos**

- [x] Pe√≥n (movimiento doble inicial, promoci√≥n)
- [x] Torre (movimiento horizontal/vertical)
- [x] Caballo (movimiento en L)
- [x] Alfil (movimiento diagonal)
- [x] Reina (combinaci√≥n torre + alfil)
- [x] Rey (un paso en cualquier direcci√≥n)

### ‚úÖ **Reglas Especiales**

- [x] **Enroque** (corto y largo)
- [x] **Captura al Paso** (en passant)
- [x] **Promoci√≥n de Pe√≥n**
- [x] **Detecci√≥n de Jaque**
- [x] **Detecci√≥n de Jaque Mate**
- [x] **Detecci√≥n de Ahogado**

### ‚úÖ **Condiciones de Tablas**

- [x] Material insuficiente
- [x] Triple repetici√≥n de posici√≥n
- [x] Regla de los 50 movimientos
- [x] Ahogado

## ü§ñ Inteligencia Artificial

### Arquitectura de IA

- **Librer√≠a Base**: `python-chess` para l√≥gica de ajedrez y manejo de tablero
- **Motor UCI**: Comunicaci√≥n con Stockfish (si est√° disponible)
- **Fallback Inteligente**: Algoritmo simple interno si Stockfish no est√° instalado
- **Niveles de Dificultad**: 1-10 configurados por tiempo de c√°lculo

### Configuraci√≥n de IA

```python
# Niveles disponibles (con Stockfish)
NIVEL_1 = "Principiante"    # 0.1s de c√°lculo
NIVEL_3 = "Intermedio"      # 0.5s de c√°lculo
NIVEL_5 = "Avanzado"        # 1.0s de c√°lculo
NIVEL_10 = "Experto"        # 3.0s de c√°lculo

# Sin Stockfish: algoritmo aleatorio mejorado
```

## üìà Funcionalidades Avanzadas

### üïê **Sistema de Temporizadores**

- Modalidades oficiales (Cl√°sico, R√°pido, Blitz)
- Incremento por movimiento
- Visualizaci√≥n en tiempo real

### üìù **Historial y Notaci√≥n**

- Notaci√≥n algebraica est√°ndar (SAN)
- Exportaci√≥n PGN para compatibilidad
- Historial completo de partida

### üé® **Interfaz Avanzada**

- Resaltado de movimientos v√°lidos
- Indicadores visuales de capturas
- Animaciones suaves
- Popups informativos

## üõ†Ô∏è Desarrollo y Contribuci√≥n

### Reglas de Desarrollo

- **OOP Puro**: Una clase por archivo
- **Comentarios en Espa√±ol**: Documentaci√≥n clara
- **Logging**: Sin prints, solo logging
- **Tests**: Pytest para todas las funcionalidades
- **MVC Estricto**: Separaci√≥n clara de responsabilidades

### Estructura de Commits

```bash
git commit -m "feat(model): a√±adir validaci√≥n de enroque"
git commit -m "fix(view): corregir renderizado de piezas"
git commit -m "docs(readme): actualizar documentaci√≥n"
```

## üêõ Debugging y Logs

El sistema incluye logging avanzado:

```python
# Configuraci√≥n en main.py
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

## üë• Equipo de Desarrollo

- **Desarrolladores**: Pol Cabezas Agust√≠, Ignasi Ruiz Belager
- **Asistente IA**: Claude Sonnet 4 (An√°lisis y Documentaci√≥n)

## üôè Agradecimientos

- **Python-chess Team**: Por la excelente librer√≠a de ajedrez
- **Stockfish Team**: Por el potente motor de ajedrez UCI
- **Pygame Community**: Por la fant√°stica librer√≠a gr√°fica
- **FIDE**: Por las reglas oficiales del ajedrez

---

‚≠ê **¬°Si te gusta este proyecto, dale una estrella!** ‚≠ê
